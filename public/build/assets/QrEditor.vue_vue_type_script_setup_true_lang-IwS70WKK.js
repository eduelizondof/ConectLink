import{d as Z,r as z,z as oo,A as L,b as R,L as eo,e as g,j as t,f as s,g as o,m as d,w as r,k as h,l as m,F as c,q as p,t as _,K as D}from"./vendor-eHrDt6OH.js";import{u as lo}from"./useSwal-DOVGsU6a.js";import{_ as i}from"./Label.vue_vue_type_script_setup_true_lang-BBaMjydA.js";import{_ as C}from"./index-DdtZ7dV8.js";import{_ as $}from"./Checkbox.vue_vue_type_script_setup_true_lang-Cc9ipdgV.js";import{b as v,c as b,d as y,e as x,a as V,_ as F,S as so}from"./SelectValue.vue_vue_type_script_setup_true_lang-BSiSxfzO.js";import{_ as k}from"./ColorPicker.vue_vue_type_script_setup_true_lang-C-ZSxaER.js";import ao from"./QrPreview-9ic8-dPf.js";import{c as to}from"./createLucideIcon-jrbd9Vvj.js";import{P as ro}from"./palette-CruBC_89.js";import{I as no}from"./image-CWtdtVbT.js";import{R as io}from"./refresh-cw-vjyuOYd-.js";import{S as uo}from"./save-6D_K-x3C.js";import{D as S}from"./download-ws05y8K7.js";import{C as go}from"./credit-card-b-4-kBLY.js";import{E as mo}from"./eye-DDtDiHrf.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=to("QrCodeIcon",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),fo={class:"space-y-6"},co={class:"grid gap-6 lg:grid-cols-2"},po={class:"space-y-6"},vo={class:"rounded-xl border bg-card p-6"},bo={class:"mb-6 flex items-center gap-2"},yo={class:"space-y-6"},xo={class:"space-y-4"},Vo={class:"flex items-center gap-2 text-sm font-medium"},ko={class:"grid gap-4 sm:grid-cols-2"},wo={class:"space-y-2"},Co={class:"space-y-2"},Uo={class:"space-y-3"},zo={class:"flex items-center gap-3"},ho={key:0,class:"grid gap-4 sm:grid-cols-2 pl-6"},Fo={class:"space-y-2"},Eo={class:"space-y-2"},Lo={class:"space-y-2"},Ro={class:"space-y-2"},$o={class:"space-y-4 border-t pt-4"},So={class:"flex items-center gap-2 text-sm font-medium"},qo={class:"grid gap-4 sm:grid-cols-2"},Po={class:"space-y-2"},Mo={class:"space-y-2"},jo={class:"space-y-2"},Qo={class:"space-y-4 border-t pt-4"},Do={class:"flex items-center gap-2 text-sm font-medium"},No={class:"flex items-center gap-3"},Oo={key:0,class:"space-y-4 pl-6"},Bo={class:"space-y-2"},To={key:0,class:"mt-2 flex items-center gap-2 rounded-lg border p-2"},Io=["src"],Go={key:1,class:"mt-2 rounded-lg border border-dashed border-muted-foreground/30 p-2"},Ao={class:"text-xs text-muted-foreground text-center"},Ho={key:0,class:"space-y-2"},Wo={class:"grid gap-4 sm:grid-cols-2"},Ko={class:"space-y-2"},Jo={class:"space-y-2"},Xo={class:"flex items-center gap-3"},Yo={key:1,class:"space-y-2"},Zo={class:"space-y-2"},oe={class:"space-y-4 border-t pt-4"},ee={class:"flex items-center gap-2 text-sm font-medium"},le={class:"grid gap-4 sm:grid-cols-2"},se={class:"space-y-2"},ae={class:"space-y-2"},te={class:"border-t pt-4"},re={class:"space-y-6"},de={class:"rounded-xl border bg-card p-6"},ne={class:"mb-6 flex items-center justify-between"},ie={class:"flex gap-2"},ue={class:"flex justify-center"},ge={class:"rounded-xl border bg-card p-6"},me={class:"mb-4 flex items-center gap-2"},_e={class:"flex gap-3"},Le=Z({__name:"QrEditor",props:{profile:{},organization:{}},setup(N){const u=N,q=lo();z(!1);const E={foreground_color:"#000000",background_color:"#FFFFFF",dot_style:"square",corner_style:"square",corner_color:null,show_logo:!1,logo_source:"organization",custom_logo:null,logo_size:20,logo_shape:"circle",logo_background_color:"#FFFFFF",logo_background_enabled:!0,logo_margin:5,error_correction:"H",size:300,use_gradient:!1,gradient_start_color:null,gradient_end_color:null,gradient_type:"linear",gradient_rotation:0},a=oo({...E,...u.profile.qr_settings||{},custom_logo_file:null,logo_source:u.profile.qr_settings?.logo_source||E.logo_source}),f=z(a.show_logo??!1);L(()=>a.show_logo,n=>{f.value!==(n??!1)&&(f.value=n??!1)},{immediate:!0}),L(f,n=>{a.show_logo!==n&&(a.show_logo=n)});const O=[{value:"square",label:"Cuadrado"},{value:"rounded",label:"Redondeado"},{value:"dots",label:"Puntos"},{value:"classy",label:"Clásico"},{value:"classy-rounded",label:"Clásico Redondeado"},{value:"extra-rounded",label:"Extra Redondeado"}],B=[{value:"square",label:"Cuadrado"},{value:"rounded",label:"Redondeado"},{value:"extra-rounded",label:"Extra Redondeado"}],T=[{value:"square",label:"Cuadrado"},{value:"rounded",label:"Redondeado"},{value:"circle",label:"Circular"}],I=[{value:"organization",label:"Logo de Organización"},{value:"profile",label:"Foto de Perfil"},{value:"custom",label:"Personalizado"}],G=[{value:"L",label:"Bajo (7%)"},{value:"M",label:"Medio (15%)"},{value:"Q",label:"Alto (25%)"},{value:"H",label:"Máximo (30%)"}],A=[{value:"linear",label:"Lineal"},{value:"radial",label:"Radial"}],H=R(()=>{const n=window.location.origin;return u.profile.is_primary?`${n}/${u.organization.slug}`:`${n}/${u.organization.slug}/${u.profile.slug}`}),w=z([]),W=R(()=>({...a.data(),show_logo:f.value})),U=R(()=>{const n=f.value,e=a.logo_source||"organization";if(!n)return null;let l=null;switch(e){case"organization":l=u.organization.logo_url||null;break;case"profile":l=u.profile.photo_url||null;break;case"custom":if(a.custom_logo_file instanceof File){w.value.forEach(Q=>{Q.startsWith("blob:")&&URL.revokeObjectURL(Q)}),w.value=[];const j=URL.createObjectURL(a.custom_logo_file);w.value.push(j),l=j}else a.custom_logo&&(l=a.custom_logo.startsWith("http")?a.custom_logo:`${window.location.origin}/storage/${a.custom_logo}`);break;default:l=null}return l});eo(()=>{w.value.forEach(n=>{URL.revokeObjectURL(n)}),w.value=[]}),L(()=>u.profile.qr_settings,n=>{if(n){const e={...E,...n};Object.keys(e).forEach(l=>{l in a&&(a[l]=e[l])}),f.value=e.show_logo??!1}},{deep:!0,immediate:!0});function K(){const n=new FormData;Object.entries(a.data()).forEach(([e,l])=>{e==="custom_logo_file"?l instanceof File&&n.append("custom_logo",l):l!=null&&(typeof l=="boolean"?n.append(e,l?"1":"0"):n.append(e,String(l)))}),n.append("_method","PUT"),D.post(`/admin/profiles/${u.profile.id}/qr-settings`,n,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{q.success("¡Configuración del QR guardada!"),D.reload({only:["organization"]})},onError:e=>{console.error("Error al guardar:",e),q.error("Error al guardar la configuración. Por favor, verifica los datos.")}})}const P=z(null);function M(n="png"){P.value?.download(n)}function J(){window.open(`/admin/profiles/${u.profile.id}/business-card`,"_blank")}function X(){window.open(`/admin/profiles/${u.profile.id}/business-card/preview`,"_blank")}function Y(n){const e=n.target;e.files&&e.files[0]&&(a.custom_logo_file=e.files[0])}return(n,e)=>(m(),g("div",fo,[t("div",co,[t("div",po,[t("div",vo,[t("div",bo,[s(o(_o),{class:"h-5 w-5 text-primary"}),e[22]||(e[22]=t("h2",{class:"text-lg font-semibold"},"Configuración del QR",-1))]),t("div",yo,[t("div",xo,[t("h3",Vo,[s(o(ro),{class:"h-4 w-4"}),e[23]||(e[23]=d(" Colores ",-1))]),t("div",ko,[t("div",wo,[s(o(i),null,{default:r(()=>[...e[24]||(e[24]=[d("Color Principal",-1)])]),_:1}),s(o(k),{modelValue:o(a).foreground_color,"onUpdate:modelValue":e[0]||(e[0]=l=>o(a).foreground_color=l)},null,8,["modelValue"])]),t("div",Co,[s(o(i),null,{default:r(()=>[...e[25]||(e[25]=[d("Color de Fondo",-1)])]),_:1}),s(o(k),{modelValue:o(a).background_color,"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).background_color=l)},null,8,["modelValue"])])]),t("div",Uo,[t("div",zo,[s(o($),{id:"use_gradient",modelValue:o(a).use_gradient,"onUpdate:modelValue":e[2]||(e[2]=l=>o(a).use_gradient=l)},null,8,["modelValue"]),s(o(i),{for:"use_gradient",class:"cursor-pointer"},{default:r(()=>[...e[26]||(e[26]=[d(" Usar degradado ",-1)])]),_:1})]),o(a).use_gradient?(m(),g("div",ho,[t("div",Fo,[s(o(i),null,{default:r(()=>[...e[27]||(e[27]=[d("Color Inicial",-1)])]),_:1}),s(o(k),{modelValue:o(a).gradient_start_color,"onUpdate:modelValue":e[3]||(e[3]=l=>o(a).gradient_start_color=l)},null,8,["modelValue"])]),t("div",Eo,[s(o(i),null,{default:r(()=>[...e[28]||(e[28]=[d("Color Final",-1)])]),_:1}),s(o(k),{modelValue:o(a).gradient_end_color,"onUpdate:modelValue":e[4]||(e[4]=l=>o(a).gradient_end_color=l)},null,8,["modelValue"])]),t("div",Lo,[s(o(i),null,{default:r(()=>[...e[29]||(e[29]=[d("Tipo",-1)])]),_:1}),s(o(V),{modelValue:o(a).gradient_type,"onUpdate:modelValue":e[5]||(e[5]=l=>o(a).gradient_type=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(A,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),t("div",Ro,[s(o(i),null,{default:r(()=>[d("Rotación: "+_(o(a).gradient_rotation)+"°",1)]),_:1}),s(o(F),{"model-value":[o(a).gradient_rotation],"onUpdate:modelValue":e[6]||(e[6]=l=>o(a).gradient_rotation=l[0]),min:0,max:360,step:15},null,8,["model-value"])])])):h("",!0)])]),t("div",$o,[t("h3",So,[s(o(so),{class:"h-4 w-4"}),e[30]||(e[30]=d(" Estilo ",-1))]),t("div",qo,[t("div",Po,[s(o(i),null,{default:r(()=>[...e[31]||(e[31]=[d("Estilo de Puntos",-1)])]),_:1}),s(o(V),{modelValue:o(a).dot_style,"onUpdate:modelValue":e[7]||(e[7]=l=>o(a).dot_style=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(O,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),t("div",Mo,[s(o(i),null,{default:r(()=>[...e[32]||(e[32]=[d("Estilo de Esquinas",-1)])]),_:1}),s(o(V),{modelValue:o(a).corner_style,"onUpdate:modelValue":e[8]||(e[8]=l=>o(a).corner_style=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(B,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])]),t("div",jo,[s(o(i),null,{default:r(()=>[...e[33]||(e[33]=[d("Color de Esquinas (opcional)",-1)])]),_:1}),s(o(k),{modelValue:o(a).corner_color,"onUpdate:modelValue":e[9]||(e[9]=l=>o(a).corner_color=l)},null,8,["modelValue"])])]),t("div",Qo,[t("h3",Do,[s(o(no),{class:"h-4 w-4"}),e[34]||(e[34]=d(" Logo Central ",-1))]),t("div",No,[s(o($),{id:"show_logo",modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=l=>f.value=l)},null,8,["modelValue"]),s(o(i),{for:"show_logo",class:"cursor-pointer"},{default:r(()=>[...e[35]||(e[35]=[d(" Mostrar logo en el centro del QR ",-1)])]),_:1})]),f.value?(m(),g("div",Oo,[t("div",Bo,[s(o(i),null,{default:r(()=>[...e[36]||(e[36]=[d("Origen del Logo",-1)])]),_:1}),s(o(V),{modelValue:o(a).logo_source,"onUpdate:modelValue":e[11]||(e[11]=l=>o(a).logo_source=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(I,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"]),U.value?(m(),g("div",To,[t("img",{src:U.value,alt:"Logo preview",class:"h-12 w-12 rounded object-cover",onError:e[12]||(e[12]=l=>{console.error("Error loading logo:",U.value),l.target.style.display="none"})},null,40,Io),e[37]||(e[37]=t("span",{class:"text-xs text-muted-foreground"}," Logo seleccionado ",-1))])):(m(),g("div",Go,[t("p",Ao,_(o(a).logo_source==="organization"&&!u.organization.logo_url?"No hay logo de organización disponible":o(a).logo_source==="profile"&&!u.profile.photo_url?"No hay foto de perfil disponible":o(a).logo_source==="custom"&&!o(a).custom_logo&&!o(a).custom_logo_file?"Selecciona un logo personalizado":"No hay logo disponible"),1)]))]),o(a).logo_source==="custom"?(m(),g("div",Ho,[s(o(i),null,{default:r(()=>[...e[38]||(e[38]=[d("Logo Personalizado",-1)])]),_:1}),t("input",{type:"file",accept:"image/*",onChange:Y,class:"w-full rounded-lg border bg-background px-4 py-2 text-sm"},null,32)])):h("",!0),t("div",Wo,[t("div",Ko,[s(o(i),null,{default:r(()=>[...e[39]||(e[39]=[d("Forma del Logo",-1)])]),_:1}),s(o(V),{modelValue:o(a).logo_shape,"onUpdate:modelValue":e[13]||(e[13]=l=>o(a).logo_shape=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(T,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),t("div",Jo,[s(o(i),null,{default:r(()=>[d("Tamaño: "+_(o(a).logo_size)+"%",1)]),_:1}),s(o(F),{"model-value":[o(a).logo_size],"onUpdate:modelValue":e[14]||(e[14]=l=>o(a).logo_size=l[0]),min:10,max:40,step:5},null,8,["model-value"])])]),t("div",Xo,[s(o($),{id:"logo_background_enabled",modelValue:o(a).logo_background_enabled,"onUpdate:modelValue":e[15]||(e[15]=l=>o(a).logo_background_enabled=l)},null,8,["modelValue"]),s(o(i),{for:"logo_background_enabled",class:"cursor-pointer"},{default:r(()=>[...e[40]||(e[40]=[d(" Fondo del logo ",-1)])]),_:1})]),o(a).logo_background_enabled?(m(),g("div",Yo,[s(o(i),null,{default:r(()=>[...e[41]||(e[41]=[d("Color de Fondo del Logo",-1)])]),_:1}),s(o(k),{modelValue:o(a).logo_background_color,"onUpdate:modelValue":e[16]||(e[16]=l=>o(a).logo_background_color=l)},null,8,["modelValue"])])):h("",!0),t("div",Zo,[s(o(i),null,{default:r(()=>[d("Margen: "+_(o(a).logo_margin)+"px",1)]),_:1}),s(o(F),{"model-value":[o(a).logo_margin],"onUpdate:modelValue":e[17]||(e[17]=l=>o(a).logo_margin=l[0]),min:0,max:20,step:1},null,8,["model-value"])])])):h("",!0)]),t("div",oe,[t("h3",ee,[s(o(io),{class:"h-4 w-4"}),e[42]||(e[42]=d(" Opciones Avanzadas ",-1))]),t("div",le,[t("div",se,[s(o(i),null,{default:r(()=>[...e[43]||(e[43]=[d("Corrección de Errores",-1)])]),_:1}),s(o(V),{modelValue:o(a).error_correction,"onUpdate:modelValue":e[18]||(e[18]=l=>o(a).error_correction=l)},{default:r(()=>[s(o(v),null,{default:r(()=>[s(o(b))]),_:1}),s(o(y),null,{default:r(()=>[(m(),g(c,null,p(G,l=>s(o(x),{key:l.value,value:l.value},{default:r(()=>[d(_(l.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"]),e[44]||(e[44]=t("p",{class:"text-xs text-muted-foreground"}," Mayor nivel permite más daño/logo pero reduce legibilidad ",-1))]),t("div",ae,[s(o(i),null,{default:r(()=>[d("Tamaño: "+_(o(a).size)+"px",1)]),_:1}),s(o(F),{"model-value":[o(a).size],"onUpdate:modelValue":e[19]||(e[19]=l=>o(a).size=l[0]),min:100,max:500,step:50},null,8,["model-value"])])])]),t("div",te,[s(o(C),{onClick:K,disabled:o(a).processing,class:"w-full gap-2"},{default:r(()=>[s(o(uo),{class:"h-4 w-4"}),e[45]||(e[45]=d(" Guardar Configuración ",-1))]),_:1},8,["disabled"])])])])]),t("div",re,[t("div",de,[t("div",ne,[e[48]||(e[48]=t("h2",{class:"font-semibold"},"Vista Previa",-1)),t("div",ie,[s(o(C),{variant:"outline",size:"sm",onClick:e[20]||(e[20]=l=>M("png")),class:"gap-1"},{default:r(()=>[s(o(S),{class:"h-3 w-3"}),e[46]||(e[46]=d(" PNG ",-1))]),_:1}),s(o(C),{variant:"outline",size:"sm",onClick:e[21]||(e[21]=l=>M("svg")),class:"gap-1"},{default:r(()=>[s(o(S),{class:"h-3 w-3"}),e[47]||(e[47]=d(" SVG ",-1))]),_:1})])]),t("div",ue,[s(ao,{ref_key:"qrPreviewRef",ref:P,url:H.value,settings:W.value,"logo-url":U.value},null,8,["url","settings","logo-url"])])]),t("div",ge,[t("div",me,[s(o(go),{class:"h-5 w-5 text-primary"}),e[49]||(e[49]=t("h2",{class:"font-semibold"},"Tarjeta de Presentación",-1))]),e[52]||(e[52]=t("p",{class:"mb-4 text-sm text-muted-foreground"}," Genera una tarjeta de presentación profesional con tu QR code y datos de contacto. ",-1)),t("div",_e,[s(o(C),{variant:"outline",onClick:X,class:"flex-1 gap-2"},{default:r(()=>[s(o(mo),{class:"h-4 w-4"}),e[50]||(e[50]=d(" Vista Previa ",-1))]),_:1}),s(o(C),{onClick:J,class:"flex-1 gap-2"},{default:r(()=>[s(o(S),{class:"h-4 w-4"}),e[51]||(e[51]=d(" Descargar PDF ",-1))]),_:1})])])])])]))}});export{_o as Q,Le as _};
