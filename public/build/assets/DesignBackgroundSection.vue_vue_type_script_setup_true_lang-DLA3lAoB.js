import{d as N,A as v,w as U,c as E,e as i,k as l,l as p,f as n,j as s,p as c,g as o,F as k,s as m,m as d,t as u,x as f,n as V,y as T}from"./vendor-CwJ9eRpz.js";import{u as h}from"./useSwal-DOVGsU6a.js";import{_ as y}from"./ColorPicker.vue_vue_type_script_setup_true_lang-CmaLZnPB.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-DTGu4m7n.js";import{_ as z}from"./index-aHHv8Tf2.js";import{_ as L}from"./Slider.vue_vue_type_script_setup_true_lang-CyCdErQ-.js";import{a as j,b as G,c as O,d as q,_ as A}from"./SelectValue.vue_vue_type_script_setup_true_lang-D8OnKVtz.js";import{L as H}from"./loader-circle-CXEFMlnV.js";import{S as I}from"./save-Foej4Srl.js";import{S as R}from"./square-CsgyCoI1.js";import{P as J}from"./palette-B6LxOisj.js";const K={class:"space-y-4"},M={class:"space-y-2"},Q={class:"grid grid-cols-2 gap-2"},W=["onClick"],X={key:0,class:"space-y-2"},Y={key:1,class:"space-y-4"},Z={class:"grid gap-4 sm:grid-cols-2"},aa={class:"space-y-2"},oa={class:"grid grid-cols-4 gap-2"},ea=["onClick"],ra={class:"space-y-2"},na={key:2,class:"space-y-2"},ta={class:"flex justify-end pt-2"},ma=N({__name:"DesignBackgroundSection",props:{profile:{}},emits:["updated"],setup(x,{expose:C,emit:D}){const g=x,$=D,b=h(),a=v({background_type:"solid",background_color:"#ffffff",background_gradient_start:"#3b82f6",background_gradient_end:"#8b5cf6",background_gradient_direction:"to-b",background_pattern:"none",background_pattern_opacity:10});U(()=>g.profile,t=>{if(t?.settings){const r=t.settings,e=r.background_type||"solid";e==="solid"||e==="gradient"?(a.background_type=e,a.background_color=r.background_color||"#ffffff",a.background_gradient_start=r.background_gradient_start||"#3b82f6",a.background_gradient_end=r.background_gradient_end||"#8b5cf6",a.background_gradient_direction=r.background_gradient_direction||"to-b"):(a.background_type="solid",a.background_color=r.background_color||"#ffffff"),a.background_pattern=r.background_pattern||"none",a.background_pattern_opacity=r.background_pattern_opacity||10}},{immediate:!0});const S=[{value:"solid",label:"Color sólido",icon:R},{value:"gradient",label:"Gradiente",icon:J}],w=[{value:"to-b",label:"Vertical ↓"},{value:"to-r",label:"Horizontal →"},{value:"to-br",label:"Diagonal ↘"},{value:"to-bl",label:"Diagonal ↙"}],F=[{value:"none",label:"Ninguno"},{value:"dots",label:"Puntos"},{value:"grid",label:"Cuadrícula"},{value:"waves",label:"Ondas"},{value:"noise",label:"Ruido"}];function P(){if(!g.profile)return;if(console.log("Form values:",{background_type:a.background_type,background_color:a.background_color,background_gradient_start:a.background_gradient_start,background_gradient_end:a.background_gradient_end,background_gradient_direction:a.background_gradient_direction,background_pattern:a.background_pattern,background_pattern_opacity:a.background_pattern_opacity}),!a.background_type){console.error("background_type is missing!"),b.error("Por favor selecciona un tipo de fondo");return}const t={background_type:a.background_type,background_pattern:a.background_pattern||"none",background_pattern_opacity:a.background_pattern_opacity??10};console.log("Initial submitData:",t),a.background_type==="solid"?a.background_color&&(t.background_color=a.background_color):a.background_type==="gradient"&&(a.background_gradient_start&&(t.background_gradient_start=a.background_gradient_start),a.background_gradient_end&&(t.background_gradient_end=a.background_gradient_end),a.background_gradient_direction&&(t.background_gradient_direction=a.background_gradient_direction)),console.log("Final submitData before form creation:",t),console.log("submitData.background_type:",t.background_type),v(t).put(`/admin/profiles/${g.profile.id}/design/background`,{preserveScroll:!0,onSuccess:()=>{b.success("¡Fondo guardado!"),$("updated")},onError:e=>{console.error("Error saving background:",e),console.error("Submitted data:",t),b.error("Error al guardar. Verifica los datos e intenta de nuevo.")}})}return C({formData:E(()=>a.data())}),(t,r)=>(d(),i("div",K,[l("div",M,[n(o(_),null,{default:s(()=>[...r[5]||(r[5]=[c("Tipo de fondo",-1)])]),_:1}),l("div",Q,[(d(),i(k,null,m(S,e=>l("button",{key:e.value,onClick:B=>o(a).background_type=e.value,class:V(["flex flex-col items-center gap-1 rounded-lg border p-3 text-xs transition-colors",o(a).background_type===e.value?"border-primary bg-primary/5 text-primary":"hover:bg-muted"])},[(d(),f(T(e.icon),{class:"h-4 w-4"})),c(" "+u(e.label),1)],10,W)),64))])]),o(a).background_type==="solid"?(d(),i("div",X,[n(o(y),{modelValue:o(a).background_color,"onUpdate:modelValue":r[0]||(r[0]=e=>o(a).background_color=e),label:"Color de fondo"},null,8,["modelValue"])])):p("",!0),o(a).background_type==="gradient"?(d(),i("div",Y,[l("div",Z,[n(o(y),{modelValue:o(a).background_gradient_start,"onUpdate:modelValue":r[1]||(r[1]=e=>o(a).background_gradient_start=e),label:"Color inicial"},null,8,["modelValue"]),n(o(y),{modelValue:o(a).background_gradient_end,"onUpdate:modelValue":r[2]||(r[2]=e=>o(a).background_gradient_end=e),label:"Color final"},null,8,["modelValue"])]),l("div",aa,[n(o(_),null,{default:s(()=>[...r[6]||(r[6]=[c("Dirección",-1)])]),_:1}),l("div",oa,[(d(),i(k,null,m(w,e=>l("button",{key:e.value,onClick:B=>o(a).background_gradient_direction=e.value,class:V(["rounded-lg border px-2 py-1.5 text-xs transition-colors",o(a).background_gradient_direction===e.value?"border-primary bg-primary/5 text-primary":"hover:bg-muted"])},u(e.label),11,ea)),64))])])])):p("",!0),l("div",ra,[n(o(_),null,{default:s(()=>[...r[7]||(r[7]=[c("Patrón de fondo",-1)])]),_:1}),n(o(A),{modelValue:o(a).background_pattern,"onUpdate:modelValue":r[3]||(r[3]=e=>o(a).background_pattern=e)},{default:s(()=>[n(o(j),null,{default:s(()=>[n(o(G))]),_:1}),n(o(O),null,{default:s(()=>[(d(),i(k,null,m(F,e=>n(o(q),{key:e.value,value:e.value},{default:s(()=>[c(u(e.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])]),o(a).background_pattern!=="none"?(d(),i("div",na,[n(o(_),null,{default:s(()=>[c("Opacidad del patrón: "+u(o(a).background_pattern_opacity)+"%",1)]),_:1}),n(o(L),{"model-value":[o(a).background_pattern_opacity],"onUpdate:modelValue":r[4]||(r[4]=e=>o(a).background_pattern_opacity=e?.[0]??10),max:50,step:5},null,8,["model-value"])])):p("",!0),l("div",ta,[n(o(z),{onClick:P,disabled:o(a).processing,size:"sm",class:"gap-1.5"},{default:s(()=>[o(a).processing?(d(),f(o(H),{key:0,class:"h-4 w-4 animate-spin"})):(d(),f(o(I),{key:1,class:"h-4 w-4"})),r[8]||(r[8]=c(" Guardar Fondo ",-1))]),_:1},8,["disabled"])])]))}});export{ma as _};
