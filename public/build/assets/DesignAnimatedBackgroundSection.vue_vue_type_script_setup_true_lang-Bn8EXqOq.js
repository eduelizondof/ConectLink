import{d as D,A as E,r as F,c as v,w as L,e as c,k as t,f as d,l as k,j as u,p as g,g as o,t as y,P as M,x,m as s}from"./vendor-CwJ9eRpz.js";import{u as N}from"./useSwal-DOVGsU6a.js";import{_ as h}from"./Label.vue_vue_type_script_setup_true_lang-DTGu4m7n.js";import{_ as S}from"./index-aHHv8Tf2.js";import{_ as U}from"./Slider.vue_vue_type_script_setup_true_lang-CyCdErQ-.js";import{T as z}from"./triangle-alert-BvMonCjJ.js";import{X as C}from"./x-BzXzP8xs.js";import{I as P}from"./image-DEgvf-8L.js";import{T as R}from"./trash-2-CHHS8M2q.js";import{L as G}from"./loader-circle-CXEFMlnV.js";import{S as O}from"./save-Foej4Srl.js";const W={class:"space-y-4"},X={class:"space-y-2"},q={key:0,class:"flex items-start gap-2 rounded-lg border border-amber-200 bg-amber-50 p-3 text-sm text-amber-800 dark:border-amber-800 dark:bg-amber-950 dark:text-amber-200"},H={class:"space-y-2"},J={class:"space-y-2"},K={class:"flex items-center gap-2"},Q={for:"animated-media-input",class:"flex items-center gap-2 px-4 py-2 border rounded-lg cursor-pointer hover:bg-muted transition-colors"},Y={key:0,class:"relative rounded-lg overflow-hidden border bg-muted/50"},Z=["src"],ee=["src"],ae={class:"absolute top-2 left-2 px-2 py-1 rounded bg-black/50 text-white text-xs"},oe={key:1,class:"text-xs text-muted-foreground"},te={class:"space-y-2"},ne={class:"flex items-center justify-between pt-2"},ie={key:1},be=D({__name:"DesignAnimatedBackgroundSection",props:{profile:{}},emits:["updated"],setup(f,{expose:B,emit:I}){const i=f,b=I,l=N(),a=E({background_type:"animated",background_animated_media:null,background_animated_media_type:"image",background_animated_overlay_opacity:0}),m=F(!1),V=v(()=>!!i.profile?.settings?.background_animated_media),p=F(!1);L(()=>i.profile,r=>{if(r?.settings){const e=r.settings;a.background_animated_overlay_opacity=e.background_animated_overlay_opacity||0,a.background_animated_media_type=e.background_animated_media_type||"image",a.background_animated_media=null,p.value=!1}},{immediate:!0});const _=v(()=>p.value?null:a.background_animated_media?URL.createObjectURL(a.background_animated_media):i.profile?.settings?.background_animated_media?`/storage/${i.profile.settings.background_animated_media}`:null);function A(r){const n=r.target.files?.[0];if(n){a.background_animated_media=n,p.value=!1,m.value=!0;const w=n.name.split(".").pop()?.toLowerCase();["mp4","webm","ogg"].includes(w||"")?a.background_animated_media_type="video":w==="gif"?a.background_animated_media_type="gif":a.background_animated_media_type="image"}}function T(){a.background_animated_media=null,m.value=!1;const r=document.getElementById("animated-media-input");r&&(r.value="")}async function $(){if(!i.profile)return;await l.confirm({title:"¿Eliminar fondo animado?",text:"Esto eliminará el fondo animado y volverá al fondo configurado (sólido o gradiente).",confirmText:"Eliminar",cancelText:"Cancelar"})&&E({background_type:"solid",background_color:i.profile?.settings?.background_color||"#ffffff",delete_animated_background:!0}).put(`/admin/profiles/${i.profile.id}/design/background`,{preserveScroll:!0,onSuccess:()=>{l.success("¡Fondo animado eliminado!"),b("updated"),a.background_animated_media=null,a.background_animated_overlay_opacity=0,m.value=!1,p.value=!0;const n=document.getElementById("animated-media-input");n&&(n.value="")},onError:n=>{console.error("Error deleting animated background:",n),l.error("Error al eliminar. Intenta de nuevo.")}})}function j(){if(!i.profile)return;a.background_type="animated",a.background_animated_media instanceof File?a.transform(e=>({...e,_method:"PUT"})).post(`/admin/profiles/${i.profile.id}/design/background`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{l.success("¡Fondo animado guardado!"),b("updated"),a.background_animated_media=null,m.value=!1},onError:e=>{console.error("Error saving animated background:",e),l.error("Error al guardar. Verifica los datos e intenta de nuevo.")}}):a.transform(e=>{const n={background_type:e.background_type,background_animated_overlay_opacity:e.background_animated_overlay_opacity};return i.profile?.settings?.background_animated_media&&e.background_animated_media_type&&(n.background_animated_media_type=e.background_animated_media_type),n}).put(`/admin/profiles/${i.profile.id}/design/background`,{preserveScroll:!0,onSuccess:()=>{l.success("¡Fondo animado guardado!"),b("updated"),m.value=!1},onError:e=>{console.error("Error saving animated background:",e),l.error("Error al guardar. Verifica los datos e intenta de nuevo.")}})}return B({formData:v(()=>a.data())}),(r,e)=>(s(),c("div",W,[t("div",X,[d(o(h),null,{default:u(()=>[...e[2]||(e[2]=[g("Imágen de fondo",-1)])]),_:1}),e[4]||(e[4]=t("p",{class:"text-xs text-muted-foreground"}," Sube una imágen para usar como fondo ",-1)),m.value?(s(),c("div",q,[d(o(z),{class:"h-4 w-4 mt-0.5 flex-shrink-0"}),e[3]||(e[3]=t("div",null,[t("p",{class:"font-medium"},"Advertencia"),t("p",{class:"text-xs mt-1"}," Al guardar esta imágen de fondo, se mostrará por encima del fondo configurado (sólido o gradiente) y lo reemplazará visualmente. ")],-1)),t("button",{onClick:e[0]||(e[0]=n=>m.value=!1),class:"ml-auto p-1 rounded hover:bg-amber-100 dark:hover:bg-amber-900 transition-colors"},[d(o(C),{class:"h-3 w-3"})])])):k("",!0)]),t("div",H,[d(o(h),null,{default:u(()=>[...e[5]||(e[5]=[g("Archivo (Imágen)",-1)])]),_:1}),t("div",J,[t("div",K,[t("input",{id:"animated-media-input",type:"file",accept:"image/*,video/*,.gif",onChange:A,class:"hidden"},null,32),t("label",Q,[d(o(P),{class:"h-4 w-4"}),e[6]||(e[6]=t("span",{class:"text-sm"},"Seleccionar archivo",-1))])]),_.value?(s(),c("div",Y,[o(a).background_animated_media_type==="video"?(s(),c("video",{key:0,src:_.value,autoplay:"",loop:"",muted:"",class:"w-full h-48 object-cover"},null,8,Z)):(s(),c("img",{key:1,src:_.value,alt:"Preview",class:"w-full h-48 object-cover"},null,8,ee)),t("button",{onClick:T,class:"absolute top-2 right-2 p-1.5 rounded-full bg-black/50 hover:bg-black/70 text-white transition-colors"},[d(o(C),{class:"h-4 w-4"})]),t("div",ae,y(o(a).background_animated_media_type==="video"?"Video":o(a).background_animated_media_type==="gif"?"GIF":"Imagen"),1)])):k("",!0),!_.value&&f.profile?.settings?.background_animated_media?(s(),c("div",oe," Media actual: "+y(f.profile.settings.background_animated_media_type||"image"),1)):k("",!0)])]),t("div",te,[d(o(h),null,{default:u(()=>[g("Opacidad del fondo: "+y(o(a).background_animated_overlay_opacity)+"%",1)]),_:1}),d(o(U),{"model-value":[o(a).background_animated_overlay_opacity],"onUpdate:modelValue":e[1]||(e[1]=n=>o(a).background_animated_overlay_opacity=n?.[0]??0),max:100,step:5},null,8,["model-value"]),e[7]||(e[7]=M('<div class="rounded-lg border bg-muted/30 p-3 space-y-1"><p class="text-xs font-medium text-foreground"> ¿Cómo funciona la opacidad del fondo? </p><p class="text-xs text-muted-foreground leading-relaxed"> Esta opción agrega una capa oscura sobre tu fondo animado para mejorar la legibilidad del contenido. <span class="font-medium">0%</span> = fondo completamente visible, <span class="font-medium">100%</span> = fondo completamente oscuro. Recomendamos entre 20-40% para un buen balance entre visibilidad del fondo y legibilidad del texto. </p></div>',1))]),t("div",ne,[V.value?(s(),x(o(S),{key:0,onClick:$,disabled:o(a).processing,variant:"destructive",size:"sm",class:"gap-1.5"},{default:u(()=>[d(o(R),{class:"h-4 w-4"}),e[8]||(e[8]=g(" Eliminar Fondo de imágen ",-1))]),_:1},8,["disabled"])):(s(),c("div",ie)),d(o(S),{onClick:j,disabled:o(a).processing,size:"sm",class:"gap-1.5"},{default:u(()=>[o(a).processing?(s(),x(o(G),{key:0,class:"h-4 w-4 animate-spin"})):(s(),x(o(O),{key:1,class:"h-4 w-4"})),e[9]||(e[9]=g(" Guardar Fondo de imágen ",-1))]),_:1},8,["disabled"])])]))}});export{be as _};
