import{g as x,u as P,a as S,_ as C,b as N,c as $,d as L}from"./ProductsCatalog.vue_vue_type_script_setup_true_lang-CKgOTfHu.js";import{D as j}from"./download-Dhrr9OQm.js";import{E as B}from"./eye-CMurwkyG.js";import{d as E,c as n,e as d,k as l,l as m,v as u,f as _,x as M,p as V,g as y,m as c}from"./vendor-CwJ9eRpz.js";const A={class:"relative rounded-2xl border shadow-lg overflow-hidden",style:{"max-height":"600px"}},F={class:"absolute inset-0 z-0 overflow-hidden rounded-2xl"},D={key:0,class:"absolute inset-0 overflow-hidden rounded-2xl"},H=["src"],O=["src"],X={class:"px-4 py-6"},G={class:"flex justify-center mt-6"},J=E({__name:"ProfilePreview",props:{profile:{},organization:{}},setup(v){const i=v,{getBrandColor:w}=S();console.log("ProfilePreview - Organization data:",{organization:i.organization,products:i.organization.products,productCategories:i.organization.productCategories,productSections:i.organization.productSections,productsLength:i.organization.products?.length,sectionsLength:i.organization.productSections?.length,hasProductCategories:"productCategories"in i.organization,hasProductSections:"productSections"in i.organization,organizationKeys:Object.keys(i.organization)});const s=n(()=>{const a=x(),o=i.profile.settings||{};console.log("ðŸ” [ProfilePreview] Raw profile settings:",{profile_settings:o,card_shadow_raw:o.card_shadow,card_shadow_type:typeof o.card_shadow,card_glow_enabled_raw:o.card_glow_enabled,card_glow_enabled_type:typeof o.card_glow_enabled,card_glow_duration_raw:o.card_glow_duration,card_glow_duration_type:typeof o.card_glow_duration,card_glow_opacity_raw:o.card_glow_opacity,card_glow_opacity_type:typeof o.card_glow_opacity});const r={...a,...o,background_type:o.background_type||a.background_type,background_color:o.background_color||a.background_color,background_gradient_start:o.background_gradient_start||a.background_gradient_start,background_gradient_end:o.background_gradient_end||a.background_gradient_end,background_gradient_direction:o.background_gradient_direction||a.background_gradient_direction,background_animated_media:o.background_animated_media,background_animated_media_type:o.background_animated_media_type,background_animated_overlay_opacity:o.background_animated_overlay_opacity??a.background_animated_overlay_opacity,primary_color:o.primary_color||a.primary_color,text_color:o.text_color||a.text_color,text_secondary_color:o.text_secondary_color||a.text_secondary_color,card_style:o.card_style||a.card_style,card_background_color:o.card_background_color||a.card_background_color,card_border_radius:o.card_border_radius||a.card_border_radius,card_shadow:o.card_shadow??a.card_shadow,card_border_color:o.card_border_color||a.card_border_color,card_glow_enabled:o.card_glow_enabled??a.card_glow_enabled,card_glow_color:o.card_glow_color||a.card_glow_color,card_glow_color_secondary:o.card_glow_color_secondary||a.card_glow_color_secondary,card_glow_variant:o.card_glow_variant||a.card_glow_variant,card_glow_duration:o.card_glow_duration!==void 0?Number(o.card_glow_duration):a.card_glow_duration,card_glow_opacity:o.card_glow_opacity!==void 0?Number(o.card_glow_opacity):a.card_glow_opacity,photo_style:o.photo_style||a.photo_style,photo_size:o.photo_size||"md",social_style:o.social_style||a.social_style,social_size:o.social_size||a.social_size,social_colored:o.social_colored??a.social_colored,show_profile_photo:o.show_profile_photo??a.show_profile_photo};return console.log("âœ… [ProfilePreview] Normalized settings:",{card_shadow:r.card_shadow,card_shadow_type:typeof r.card_shadow,card_glow_enabled:r.card_glow_enabled,card_glow_enabled_type:typeof r.card_glow_enabled,card_glow_duration:r.card_glow_duration,card_glow_duration_type:typeof r.card_glow_duration,card_glow_opacity:r.card_glow_opacity,card_glow_opacity_type:typeof r.card_glow_opacity}),r}),{backgroundStyle:h}=P(s),p=n(()=>{const a=i.profile.social_links||i.profile.socialLinks||[],r=(i.profile.custom_links||i.profile.customLinks||[]).map((e,t)=>({...e,sort_order:e.sort_order??t}));return{id:i.profile.id,name:i.profile.name,slug:void 0,photo:i.profile.photo?`/storage/${i.profile.photo}`:void 0,job_title:i.profile.job_title,slogan:i.profile.slogan,bio:i.profile.bio,is_primary:!1,views_count:0,settings:s.value,social_links:a.map(e=>({id:e.id,platform:e.platform,url:e.url,label:e.label||e.display_label||e.platform,icon:e.icon,brand_color:e.brand_color||w(e.platform)})),custom_links:r.map(e=>({id:e.id,title:e.title,url:e.url,description:e.description,icon:e.icon,thumbnail:e.thumbnail,image:e.image,image_position:e.image_position,image_shape:e.image_shape,button_color:e.button_color,text_color:e.text_color,is_highlighted:e.is_highlighted||!1})),floating_alerts:[]}}),z=n(()=>({id:0,name:i.organization.name,slug:"",logo:i.organization.logo,logo_url:i.organization.logo_url||(i.organization.logo?`/storage/${i.organization.logo}`:void 0),type:"business",description:void 0})),f=n(()=>{const a=i.organization.products||[];return console.log("ProfilePreview - Normalizing products:",a),a.filter(o=>o.is_active!==!1).map(o=>({id:o.id,name:o.name,slug:o.slug,short_description:o.short_description,description:o.description,price:o.price?parseFloat(o.price):void 0,sale_price:o.sale_price?parseFloat(o.sale_price):void 0,currency:o.currency||"MXN",image:o.image?`/storage/${o.image}`:o.image_url||void 0,gallery:o.gallery,external_url:o.external_url,whatsapp_message:o.whatsapp_message,is_featured:o.is_featured||!1,is_available:o.is_available??!0,category:o.category?{id:o.category.id,name:o.category.name,slug:o.category.slug}:void 0}))}),k=n(()=>{let a=i.organization.productCategories||[];if(a.length===0){const o=new Map;(i.organization.products||[]).forEach(e=>{if(e.category&&e.category.id){o.has(e.category.id)||o.set(e.category.id,{id:e.category.id,name:e.category.name,slug:e.category.slug,products_count:0});const t=o.get(e.category.id);t.products_count=(t.products_count||0)+1}}),a=Array.from(o.values())}return console.log("ProfilePreview - Normalizing categories:",a),a.map(o=>({id:o.id,name:o.name,slug:o.slug,products_count:o.products_count||0}))}),b=n(()=>{let a=i.organization.productSections||[];if(a.length===0){const o=new Map;(i.organization.products||[]).forEach(e=>{e.sections&&Array.isArray(e.sections)&&e.sections.length>0&&e.sections.forEach(t=>{t&&t.id&&(o.has(t.id)||o.set(t.id,{id:t.id,title:t.title||t.name,slug:t.slug,description:t.description,icon:t.icon,products:[]}),o.get(t.id).products.push(e))})}),a=Array.from(o.values())}return console.log("ProfilePreview - Normalizing sections:",a),a.filter(o=>o.is_active!==!1).map(o=>({id:o.id,title:o.title,slug:o.slug,description:o.description,icon:o.icon,products:(o.products||[]).map(r=>({id:r.id,name:r.name,slug:r.slug,short_description:r.short_description,description:r.description,price:r.price?parseFloat(r.price):void 0,sale_price:r.sale_price?parseFloat(r.sale_price):void 0,currency:r.currency||"MXN",image:r.image?`/storage/${r.image}`:r.image_url||void 0,gallery:r.gallery,external_url:r.external_url,whatsapp_message:r.whatsapp_message,is_featured:r.is_featured||!1,is_available:r.is_available??!0,category:r.category?{id:r.category.id,name:r.category.name,slug:r.category.slug}:void 0}))}))}),g=n(()=>!0);return(a,o)=>(c(),d("div",A,[o[2]||(o[2]=l("div",{class:"absolute inset-x-0 top-0 h-6 bg-black rounded-t-2xl flex items-center justify-center z-10"},[l("div",{class:"w-20 h-4 bg-black rounded-full"})],-1)),l("div",F,[s.value.background_type==="animated"&&s.value.background_animated_media?(c(),d("div",D,[s.value.background_animated_media_type==="video"?(c(),d("video",{key:0,src:`/storage/${s.value.background_animated_media}`,autoplay:"",loop:"",muted:"",playsinline:"",class:"absolute inset-0 w-full h-full object-cover"},null,8,H)):(c(),d("img",{key:1,src:`/storage/${s.value.background_animated_media}`,alt:"Background",class:"absolute inset-0 w-full h-full object-cover"},null,8,O)),(s.value.background_animated_overlay_opacity||0)>0?(c(),d("div",{key:2,class:"absolute inset-0 bg-black pointer-events-none",style:u({opacity:(s.value.background_animated_overlay_opacity||0)/100})},null,4)):m("",!0)])):m("",!0)]),l("div",{class:"relative pt-6 overflow-y-auto z-10",style:u({...y(h),minHeight:"500px",maxHeight:"600px"})},[l("div",X,[_(C,{profile:p.value,organization:z.value,settings:s.value,"is-loaded":g.value},null,8,["profile","organization","settings","is-loaded"]),_(N,{links:p.value.social_links,settings:s.value,"is-loaded":g.value},null,8,["links","settings","is-loaded"]),_($,{links:p.value.custom_links,settings:s.value,"is-loaded":g.value},null,8,["links","settings","is-loaded"]),f.value.length>0||b.value.length>0?(c(),M(L,{key:0,products:f.value,categories:k.value,sections:b.value,settings:s.value,"is-loaded":g.value},null,8,["products","categories","sections","settings","is-loaded"])):m("",!0),l("div",G,[l("button",{class:"inline-flex items-center gap-2 px-6 py-2 rounded-lg text-sm font-medium text-white transition-all hover:scale-105",style:u({backgroundColor:s.value.primary_color})},[_(y(j),{class:"w-4 h-4"}),o[0]||(o[0]=V(" Guardar Contacto ",-1))],4)]),l("div",{class:"flex items-center justify-center gap-1 text-xs opacity-50 mt-4",style:u({color:s.value.text_secondary_color})},[_(y(B),{class:"w-3 h-3"}),o[1]||(o[1]=l("span",null,"Vista previa",-1))],4)])],4)]))}});export{J as _};
