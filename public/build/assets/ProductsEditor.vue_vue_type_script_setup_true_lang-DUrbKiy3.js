import{d as ie,r as V,b as re,L as ne,M as de,z as N,e as u,j as a,k as g,f as o,t as f,v as z,w as i,m as n,g as t,F as D,q as h,l as d,y as j,B as P,J as H,C as F,n as E,K as T}from"./vendor-eHrDt6OH.js";import{u as ue}from"./useSwal-DOVGsU6a.js";import{_ as me}from"./ImageUpload.vue_vue_type_script_setup_true_lang-xpz27FlT.js";import{_ as x}from"./Input.vue_vue_type_script_setup_true_lang-BnuwhoGL.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-BBaMjydA.js";import{_ as c}from"./index-DdtZ7dV8.js";import{_ as A}from"./Checkbox.vue_vue_type_script_setup_true_lang-Cc9ipdgV.js";import{_ as q,a as B,b as X,c as G}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BluiFz-A.js";import{T as pe}from"./tag--yQnzEML.js";import{P as J}from"./plus-Ba9tyEbA.js";import{P as K}from"./package-0GrMN_be.js";import{P as O}from"./pencil-DW-C-4f_.js";import{T as W}from"./trash-2-FY7NsgHU.js";import{S as ce}from"./star-Co3dg2Gr.js";const fe={class:"space-y-6"},ge={class:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},ve={class:"text-sm text-muted-foreground"},ye={class:"flex gap-2"},_e={key:0,class:"flex flex-wrap gap-2"},xe=["onClick"],be=["onClick"],we={key:1,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ke={class:"aspect-square bg-muted relative"},Ce=["src","alt"],Ve={key:1,class:"h-full w-full flex items-center justify-center"},Pe={class:"absolute top-2 left-2 flex gap-1"},Ue={key:0,class:"rounded-full bg-amber-500 px-2 py-0.5 text-[10px] font-medium text-white"},$e={key:1,class:"rounded-full bg-red-500 px-2 py-0.5 text-[10px] font-medium text-white"},Se={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity"},Me={class:"p-4"},ze={class:"flex items-start justify-between gap-2"},Ne={class:"min-w-0"},De={class:"font-semibold truncate"},he={key:0,class:"text-xs text-muted-foreground"},je={key:0,class:"mt-2 flex items-center gap-2"},Fe={key:0,class:"font-bold text-primary"},Ee={class:"mt-3 flex items-center justify-between"},Te={class:"flex items-center gap-1"},Ae={key:2,class:"text-center py-16 text-muted-foreground"},qe={class:"grid gap-4 sm:grid-cols-2"},Be={class:"space-y-2 sm:col-span-2"},Xe={class:"space-y-2"},Ge=["value"],Ie={class:"space-y-2"},Le={class:"space-y-2"},He={class:"space-y-2"},Je={class:"space-y-2"},Ke={class:"space-y-2"},Oe={class:"space-y-2"},We={class:"flex flex-wrap gap-4"},Qe={class:"flex items-center gap-2"},Re={class:"flex items-center gap-2"},Ye={class:"flex justify-end gap-3 pt-2"},Ze={class:"space-y-2"},et={class:"space-y-2"},tt={class:"flex justify-end gap-3 pt-2"},st={class:"space-y-2"},ot={class:"space-y-2"},at={class:"space-y-2"},lt={class:"flex items-center gap-2"},it={class:"flex justify-end gap-3 pt-2"},wt=ie({__name:"ProductsEditor",props:{organization:{},limits:{}},setup(v){const U=v,w=ue(),y=V(!1),k=V(!1),C=V(!1),$=V(!1),_=V(null),S=V(null),Q=re(()=>(U.organization.products?.length??0)<U.limits.max_products);ne(async()=>{$.value=!0,y.value=!1,k.value=!1,C.value=!1,await de()});const l=N({name:"",slug:"",category_id:null,short_description:"",description:"",price:null,sale_price:null,currency:"MXN",image:null,whatsapp_message:"",is_featured:!1,is_available:!0}),b=N({name:"",description:""}),p=N({name:"",slug:"",description:"",is_active:!0});function I(){_.value=null,l.reset(),l.currency="MXN",l.is_available=!0,y.value=!0}function R(r){_.value=r,l.name=r.name,l.slug=r.slug||"",l.category_id=r.category_id,l.short_description=r.short_description||"",l.description=r.description||"",l.price=r.price,l.sale_price=r.sale_price,l.currency=r.currency||"MXN",l.image=null,l.whatsapp_message=r.whatsapp_message||"",l.is_featured=r.is_featured,l.is_available=r.is_available,y.value=!0}function Y(){S.value=null,b.reset(),k.value=!0}function Z(r){S.value=r,p.name=r.name,p.slug=r.slug||"",p.description=r.description||"",p.is_active=r.is_active??!0,C.value=!0}function ee(){_.value?l.transform(r=>({...r,_method:"PUT"})).post(`/admin/products/${_.value.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{y.value=!1,_.value=null,w.success("¡Producto actualizado!")}}):l.post(`/admin/organizations/${U.organization.id}/products`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{y.value=!1,w.success("¡Producto creado!")}})}function te(){b.post(`/admin/organizations/${U.organization.id}/categories`,{preserveScroll:!0,onSuccess:()=>{k.value=!1,w.success("¡Categoría creada!")}})}function se(){p.put(`/admin/categories/${S.value.id}`,{preserveScroll:!0,onSuccess:()=>{C.value=!1,S.value=null,w.success("¡Categoría actualizada!")}})}async function oe(r){await w.confirmDelete(r.name)&&T.delete(`/admin/products/${r.id}`,{preserveScroll:!0})}async function ae(r){await w.confirmDelete(r.name)&&T.delete(`/admin/categories/${r.id}`,{preserveScroll:!0})}function le(r){T.put(`/admin/products/${r.id}`,{...r,is_featured:!r.is_featured},{preserveScroll:!0})}function L(r,e){return new Intl.NumberFormat("es-MX",{style:"currency",currency:e}).format(r)}return(r,e)=>(d(),u("div",fe,[a("div",ge,[a("div",null,[e[23]||(e[23]=a("h2",{class:"text-lg font-semibold"},"Catálogo de Productos",-1)),a("p",ve,f(v.organization.products?.length??0)+"/"+f(v.limits.max_products)+" productos ",1)]),a("div",ye,[o(t(c),{variant:"outline",onClick:Y,class:"gap-1"},{default:i(()=>[o(t(pe),{class:"h-4 w-4"}),e[24]||(e[24]=n(" Nueva Categoría ",-1))]),_:1}),Q.value?(d(),z(t(c),{key:0,onClick:I,class:"gap-1"},{default:i(()=>[o(t(J),{class:"h-4 w-4"}),e[25]||(e[25]=n(" Nuevo Producto ",-1))]),_:1})):g("",!0)])]),v.organization.productCategories?.length?(d(),u("div",_e,[(d(!0),u(D,null,h(v.organization.productCategories,s=>(d(),u("div",{key:s.id,class:"flex items-center gap-2 rounded-full border bg-muted px-3 py-1 text-sm"},[a("span",null,f(s.name),1),a("button",{onClick:M=>Z(s),class:"text-muted-foreground hover:text-primary"},[o(t(O),{class:"h-3 w-3"})],8,xe),a("button",{onClick:M=>ae(s),class:"text-muted-foreground hover:text-destructive"},[o(t(W),{class:"h-3 w-3"})],8,be)]))),128))])):g("",!0),v.organization.products?.length?(d(),u("div",we,[(d(!0),u(D,null,h(v.organization.products,s=>(d(),u("div",{key:s.id,class:"group rounded-xl border bg-card overflow-hidden transition-all hover:shadow-md"},[a("div",ke,[s.image?(d(),u("img",{key:0,src:`/storage/${s.image}`,alt:s.name,class:"h-full w-full object-cover"},null,8,Ce)):(d(),u("div",Ve,[o(t(K),{class:"h-16 w-16 text-muted-foreground/30"})])),a("div",Pe,[s.is_featured?(d(),u("span",Ue," Destacado ")):g("",!0),s.sale_price?(d(),u("span",$e," Oferta ")):g("",!0)]),a("div",Se,[o(t(c),{size:"icon",variant:"secondary",class:"h-8 w-8",onClick:M=>le(s)},{default:i(()=>[o(t(ce),{class:E(["h-4 w-4",s.is_featured?"text-amber-500 fill-amber-500":""])},null,8,["class"])]),_:2},1032,["onClick"])])]),a("div",Me,[a("div",ze,[a("div",Ne,[a("h3",De,f(s.name),1),s.category?(d(),u("p",he,f(s.category.name),1)):g("",!0)])]),s.price?(d(),u("div",je,[s.sale_price?(d(),u("span",Fe,f(L(s.sale_price,s.currency)),1)):g("",!0),a("span",{class:E(s.sale_price?"text-sm line-through text-muted-foreground":"font-bold text-primary")},f(L(s.price,s.currency)),3)])):g("",!0),a("div",Ee,[a("span",{class:E(["rounded-full px-2 py-0.5 text-xs font-medium",s.is_available?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-600"])},f(s.is_available?"Disponible":"No disponible"),3),a("div",Te,[o(t(c),{size:"icon",variant:"ghost",onClick:M=>R(s)},{default:i(()=>[o(t(O),{class:"h-4 w-4 text-muted-foreground"})]),_:1},8,["onClick"]),o(t(c),{size:"icon",variant:"ghost",onClick:M=>oe(s)},{default:i(()=>[o(t(W),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])])])])]))),128))])):(d(),u("div",Ae,[o(t(K),{class:"h-16 w-16 mx-auto mb-4 opacity-50"}),e[27]||(e[27]=a("h3",{class:"text-lg font-medium"},"No hay productos",-1)),e[28]||(e[28]=a("p",{class:"mt-1"},"Agrega productos a tu catálogo para mostrarlos en tu perfil.",-1)),o(t(c),{onClick:I,class:"mt-4 gap-2"},{default:i(()=>[o(t(J),{class:"h-4 w-4"}),e[26]||(e[26]=n(" Agregar Producto ",-1))]),_:1})])),o(t(G),{open:y.value,"onUpdate:open":e[12]||(e[12]=s=>y.value=s),modal:!0},{default:i(()=>[$.value?g("",!0):(d(),z(t(q),{key:0,class:"max-w-lg max-h-[90vh] overflow-y-auto"},{default:i(()=>[o(t(B),null,{default:i(()=>[o(t(X),null,{default:i(()=>[n(f(_.value?"Editar Producto":"Nuevo Producto"),1)]),_:1})]),_:1}),a("form",{onSubmit:j(ee,["prevent"]),class:"space-y-4"},[o(t(me),{modelValue:t(l).image,"onUpdate:modelValue":e[0]||(e[0]=s=>t(l).image=s),"current-image":_.value?.image,label:"Imagen","aspect-ratio":"square","max-size":2},null,8,["modelValue","current-image"]),a("div",qe,[a("div",Be,[o(t(m),{for:"product-name"},{default:i(()=>[...e[29]||(e[29]=[n("Nombre *",-1)])]),_:1}),o(t(x),{id:"product-name",modelValue:t(l).name,"onUpdate:modelValue":e[1]||(e[1]=s=>t(l).name=s),required:""},null,8,["modelValue"])]),a("div",Xe,[o(t(m),{for:"product-category"},{default:i(()=>[...e[30]||(e[30]=[n("Categoría",-1)])]),_:1}),P(a("select",{id:"product-category","onUpdate:modelValue":e[2]||(e[2]=s=>t(l).category_id=s),class:"w-full rounded-lg border bg-background px-3 py-2 text-sm"},[e[31]||(e[31]=a("option",{value:null},"Sin categoría",-1)),(d(!0),u(D,null,h(v.organization.productCategories,s=>(d(),u("option",{key:s.id,value:s.id},f(s.name),9,Ge))),128))],512),[[H,t(l).category_id]])]),a("div",Ie,[o(t(m),{for:"product-currency"},{default:i(()=>[...e[32]||(e[32]=[n("Moneda",-1)])]),_:1}),P(a("select",{id:"product-currency","onUpdate:modelValue":e[3]||(e[3]=s=>t(l).currency=s),class:"w-full rounded-lg border bg-background px-3 py-2 text-sm"},[...e[33]||(e[33]=[a("option",{value:"MXN"},"MXN (Pesos)",-1),a("option",{value:"USD"},"USD (Dólares)",-1)])],512),[[H,t(l).currency]])]),a("div",Le,[o(t(m),{for:"product-price"},{default:i(()=>[...e[34]||(e[34]=[n("Precio",-1)])]),_:1}),o(t(x),{id:"product-price",modelValue:t(l).price,"onUpdate:modelValue":e[4]||(e[4]=s=>t(l).price=s),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0"},null,8,["modelValue"])]),a("div",He,[o(t(m),{for:"product-sale_price"},{default:i(()=>[...e[35]||(e[35]=[n("Precio de oferta",-1)])]),_:1}),o(t(x),{id:"product-sale_price",modelValue:t(l).sale_price,"onUpdate:modelValue":e[5]||(e[5]=s=>t(l).sale_price=s),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0"},null,8,["modelValue"])])]),a("div",Je,[o(t(m),{for:"product-short_description"},{default:i(()=>[...e[36]||(e[36]=[n("Descripción corta",-1)])]),_:1}),o(t(x),{id:"product-short_description",modelValue:t(l).short_description,"onUpdate:modelValue":e[6]||(e[6]=s=>t(l).short_description=s),maxlength:"200"},null,8,["modelValue"])]),a("div",Ke,[o(t(m),{for:"product-description"},{default:i(()=>[...e[37]||(e[37]=[n("Descripción completa",-1)])]),_:1}),P(a("textarea",{id:"product-description","onUpdate:modelValue":e[7]||(e[7]=s=>t(l).description=s),rows:"3",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm"},null,512),[[F,t(l).description]])]),a("div",Oe,[o(t(m),{for:"product-whatsapp"},{default:i(()=>[...e[38]||(e[38]=[n("Mensaje de WhatsApp",-1)])]),_:1}),o(t(x),{id:"product-whatsapp",modelValue:t(l).whatsapp_message,"onUpdate:modelValue":e[8]||(e[8]=s=>t(l).whatsapp_message=s),placeholder:"Hola, me interesa..."},null,8,["modelValue"])]),a("div",We,[a("div",Qe,[o(t(A),{id:"product-featured",checked:t(l).is_featured,"onUpdate:checked":e[9]||(e[9]=s=>t(l).is_featured=s)},null,8,["checked"]),o(t(m),{for:"product-featured",class:"cursor-pointer"},{default:i(()=>[...e[39]||(e[39]=[n("Destacado",-1)])]),_:1})]),a("div",Re,[o(t(A),{id:"product-available",checked:t(l).is_available,"onUpdate:checked":e[10]||(e[10]=s=>t(l).is_available=s)},null,8,["checked"]),o(t(m),{for:"product-available",class:"cursor-pointer"},{default:i(()=>[...e[40]||(e[40]=[n("Disponible",-1)])]),_:1})])]),a("div",Ye,[o(t(c),{type:"button",variant:"outline",onClick:e[11]||(e[11]=s=>y.value=!1)},{default:i(()=>[...e[41]||(e[41]=[n(" Cancelar ",-1)])]),_:1}),o(t(c),{type:"submit",disabled:t(l).processing},{default:i(()=>[n(f(_.value?"Guardar Cambios":"Crear Producto"),1)]),_:1},8,["disabled"])])],32)]),_:1}))]),_:1},8,["open"]),o(t(G),{open:k.value,"onUpdate:open":e[16]||(e[16]=s=>k.value=s),modal:!0},{default:i(()=>[$.value?g("",!0):(d(),z(t(q),{key:0,class:"max-w-sm"},{default:i(()=>[o(t(B),null,{default:i(()=>[o(t(X),null,{default:i(()=>[...e[42]||(e[42]=[n("Nueva Categoría",-1)])]),_:1})]),_:1}),a("form",{onSubmit:j(te,["prevent"]),class:"space-y-4"},[a("div",Ze,[o(t(m),{for:"category-name"},{default:i(()=>[...e[43]||(e[43]=[n("Nombre *",-1)])]),_:1}),o(t(x),{id:"category-name",modelValue:t(b).name,"onUpdate:modelValue":e[13]||(e[13]=s=>t(b).name=s),required:""},null,8,["modelValue"])]),a("div",et,[o(t(m),{for:"category-description"},{default:i(()=>[...e[44]||(e[44]=[n("Descripción",-1)])]),_:1}),P(a("textarea",{id:"category-description","onUpdate:modelValue":e[14]||(e[14]=s=>t(b).description=s),rows:"2",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm"},null,512),[[F,t(b).description]])]),a("div",tt,[o(t(c),{type:"button",variant:"outline",onClick:e[15]||(e[15]=s=>k.value=!1)},{default:i(()=>[...e[45]||(e[45]=[n(" Cancelar ",-1)])]),_:1}),o(t(c),{type:"submit",disabled:t(b).processing},{default:i(()=>[...e[46]||(e[46]=[n(" Crear ",-1)])]),_:1},8,["disabled"])])],32)]),_:1}))]),_:1},8,["open"]),o(t(G),{open:C.value,"onUpdate:open":e[22]||(e[22]=s=>C.value=s),modal:!0},{default:i(()=>[$.value?g("",!0):(d(),z(t(q),{key:0,class:"max-w-sm"},{default:i(()=>[o(t(B),null,{default:i(()=>[o(t(X),null,{default:i(()=>[...e[47]||(e[47]=[n("Editar Categoría",-1)])]),_:1})]),_:1}),a("form",{onSubmit:j(se,["prevent"]),class:"space-y-4"},[a("div",st,[o(t(m),{for:"edit-category-name"},{default:i(()=>[...e[48]||(e[48]=[n("Nombre *",-1)])]),_:1}),o(t(x),{id:"edit-category-name",modelValue:t(p).name,"onUpdate:modelValue":e[17]||(e[17]=s=>t(p).name=s),required:""},null,8,["modelValue"])]),a("div",ot,[o(t(m),{for:"edit-category-slug"},{default:i(()=>[...e[49]||(e[49]=[n("Slug",-1)])]),_:1}),o(t(x),{id:"edit-category-slug",modelValue:t(p).slug,"onUpdate:modelValue":e[18]||(e[18]=s=>t(p).slug=s)},null,8,["modelValue"])]),a("div",at,[o(t(m),{for:"edit-category-description"},{default:i(()=>[...e[50]||(e[50]=[n("Descripción",-1)])]),_:1}),P(a("textarea",{id:"edit-category-description","onUpdate:modelValue":e[19]||(e[19]=s=>t(p).description=s),rows:"2",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm"},null,512),[[F,t(p).description]])]),a("div",lt,[o(t(A),{id:"edit-category-active",checked:t(p).is_active,"onUpdate:checked":e[20]||(e[20]=s=>t(p).is_active=s)},null,8,["checked"]),o(t(m),{for:"edit-category-active",class:"cursor-pointer"},{default:i(()=>[...e[51]||(e[51]=[n("Activa",-1)])]),_:1})]),a("div",it,[o(t(c),{type:"button",variant:"outline",onClick:e[21]||(e[21]=s=>C.value=!1)},{default:i(()=>[...e[52]||(e[52]=[n(" Cancelar ",-1)])]),_:1}),o(t(c),{type:"submit",disabled:t(p).processing},{default:i(()=>[...e[53]||(e[53]=[n(" Guardar ",-1)])]),_:1},8,["disabled"])])],32)]),_:1}))]),_:1},8,["open"])]))}});export{wt as _};
