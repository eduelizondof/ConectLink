import{d as K,r as U,c as H,L as J,M as O,A as $,e as p,k as o,f as l,x as w,l as c,t as v,j as a,p as r,g as t,F as Q,s as W,m as u,z as C,B as z,C as S,n as F,K as X}from"./vendor-DvujMfno.js";import{u as Y}from"./useSwal-DOVGsU6a.js";import{_ as N}from"./ImageUpload.vue_vue_type_script_setup_true_lang-B5VTKpf9.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-DLAx-lS1.js";import{_ as m}from"./Label.vue_vue_type_script_setup_true_lang-CVm8O6Ku.js";import{_}from"./index-B2djCZPx.js";import{_ as Z}from"./Checkbox.vue_vue_type_script_setup_true_lang-DG0naM3E.js";import{_ as B,a as E,b as M,c as T}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Cdo311c9.js";import{_ as ee}from"./DialogDescription.vue_vue_type_script_setup_true_lang-SI9PUyxv.js";import{P as te}from"./plus-CCPJT_Vh.js";import{S as se}from"./save-noh4y8Nr.js";import{C as le}from"./crown-CA8xqYNQ.js";import{U as oe}from"./user--XVH6PbY.js";import{P as ae}from"./pencil-BW6hGx53.js";import{T as ie}from"./trash-2-BF1stzR1.js";const re={class:"space-y-6"},ne={class:"flex items-center justify-between"},de={class:"text-sm text-muted-foreground"},ue={class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},me=["onClick"],fe={key:0,class:"absolute -right-2 -top-2 flex h-6 w-6 items-center justify-center rounded-full bg-amber-500 text-white"},pe={class:"flex items-start gap-4"},ce={class:"h-14 w-14 shrink-0 overflow-hidden rounded-full bg-muted"},ge=["src","alt"],ve={key:1,class:"flex h-full w-full items-center justify-center"},_e={class:"flex-1 min-w-0"},be={class:"font-semibold truncate"},ye={key:0,class:"text-sm text-muted-foreground truncate"},xe={key:1,class:"text-xs text-muted-foreground mt-1"},ke={class:"mt-4 flex gap-2"},Ve={class:"grid gap-4 sm:grid-cols-2"},we={class:"space-y-2"},Ce={class:"space-y-2"},je={class:"space-y-2"},Ue={class:"space-y-2"},Pe={class:"space-y-2"},$e={class:"flex justify-end gap-3 pt-4"},ze={class:"grid gap-4 sm:grid-cols-2"},Se={class:"space-y-2"},Fe={key:0,class:"space-y-2"},Ne={class:"space-y-2"},Be={class:"space-y-2"},Ee={class:"space-y-2"},Me={class:"flex items-center gap-3"},Te={class:"flex justify-end gap-3 pt-4"},Ye=K({__name:"ProfileEditor",props:{organization:{},limits:{},selectedProfileId:{}},emits:["select-profile"],setup(b,{emit:h}){const j=b,D=h,x=Y(),y=U(!1),f=U(null),k=U(!1),q=H(()=>j.organization.profiles.length<j.limits.max_profiles);J(async()=>{k.value=!0,y.value=!1,f.value=null,await O()});const d=$({name:"",slug:"",job_title:"",slogan:"",bio:"",photo:null}),i=$({name:"",slug:"",job_title:"",slogan:"",bio:"",photo:null,is_active:!0});function L(){d.reset(),y.value=!0}function A(n){f.value=n,i.name=n.name,i.slug=n.slug||"",i.job_title=n.job_title||"",i.slogan=n.slogan||"",i.bio=n.bio||"",i.is_active=n.is_active}function V(){f.value=null}function I(){d.post(`/admin/organizations/${j.organization.id}/profiles`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{y.value=!1,x.success("¡Perfil creado!")}})}function R(){f.value&&(i.photo instanceof File?i.transform(n=>({...n,_method:"PUT"})).post(`/admin/profiles/${f.value.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{V(),x.success("¡Perfil actualizado!")}}):i.transform(n=>{const{photo:e,...s}=n;return s}).put(`/admin/profiles/${f.value.id}`,{preserveScroll:!0,onSuccess:()=>{V(),x.success("¡Perfil actualizado!")}}))}async function G(n){if(n.is_primary){x.error("No puedes eliminar el perfil principal");return}await x.confirmDelete(n.name)&&X.delete(`/admin/profiles/${n.id}`,{preserveScroll:!0})}return(n,e)=>(u(),p("div",re,[o("div",ne,[o("div",null,[e[15]||(e[15]=o("h2",{class:"text-lg font-semibold"},"Perfiles",-1)),o("p",de,v(b.organization.profiles.length)+"/"+v(b.limits.max_profiles)+" perfiles ",1)]),q.value?(u(),w(t(_),{key:0,onClick:L,class:"gap-2"},{default:a(()=>[l(t(te),{class:"h-4 w-4"}),e[16]||(e[16]=r(" Nuevo Perfil ",-1))]),_:1})):c("",!0)]),o("div",ue,[(u(!0),p(Q,null,W(b.organization.profiles,s=>(u(),p("div",{key:s.id,class:F(["group relative rounded-xl border bg-card p-4 transition-all hover:border-primary/50 hover:shadow-md cursor-pointer",{"ring-2 ring-primary":b.selectedProfileId===s.id}]),onClick:P=>D("select-profile",s.id)},[s.is_primary?(u(),p("div",fe,[l(t(le),{class:"h-3 w-3"})])):c("",!0),o("div",pe,[o("div",ce,[s.photo_url?(u(),p("img",{key:0,src:s.photo_url,alt:s.name,class:"h-full w-full object-cover"},null,8,ge)):(u(),p("div",ve,[l(t(oe),{class:"h-6 w-6 text-muted-foreground"})]))]),o("div",_e,[o("h3",be,v(s.name),1),s.job_title?(u(),p("p",ye,v(s.job_title),1)):c("",!0),s.is_primary?c("",!0):(u(),p("p",xe," /"+v(b.organization.slug)+"/"+v(s.slug),1)),o("span",{class:F(["mt-2 inline-block rounded-full px-2 py-0.5 text-xs font-medium",s.is_active?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900 dark:text-emerald-300":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"])},v(s.is_active?"Activo":"Inactivo"),3)])]),o("div",ke,[l(t(_),{size:"sm",variant:"outline",class:"flex-1 gap-1",onClick:C(P=>A(s),["stop"])},{default:a(()=>[l(t(ae),{class:"h-3 w-3"}),e[17]||(e[17]=r(" Editar ",-1))]),_:1},8,["onClick"]),s.is_primary?c("",!0):(u(),w(t(_),{key:0,size:"sm",variant:"outline",class:"text-destructive hover:bg-destructive hover:text-destructive-foreground",onClick:C(P=>G(s),["stop"])},{default:a(()=>[l(t(ie),{class:"h-3 w-3"})]),_:1},8,["onClick"]))])],10,me))),128))]),l(t(T),{open:y.value,"onUpdate:open":e[7]||(e[7]=s=>y.value=s),modal:!0},{default:a(()=>[k.value?c("",!0):(u(),w(t(B),{key:0,class:"max-w-lg"},{default:a(()=>[l(t(E),null,{default:a(()=>[l(t(M),null,{default:a(()=>[...e[18]||(e[18]=[r("Nuevo Perfil",-1)])]),_:1}),l(t(ee),null,{default:a(()=>[...e[19]||(e[19]=[r(" Crea un nuevo perfil para un empleado o departamento. ",-1)])]),_:1})]),_:1}),o("form",{onSubmit:C(I,["prevent"]),class:"space-y-4"},[l(t(N),{modelValue:t(d).photo,"onUpdate:modelValue":e[0]||(e[0]=s=>t(d).photo=s),label:"Foto","aspect-ratio":"square","max-size":2},null,8,["modelValue"]),o("div",Ve,[o("div",we,[l(t(m),{for:"create-name"},{default:a(()=>[...e[20]||(e[20]=[r("Nombre *",-1)])]),_:1}),l(t(g),{id:"create-name",modelValue:t(d).name,"onUpdate:modelValue":e[1]||(e[1]=s=>t(d).name=s),required:""},null,8,["modelValue"])]),o("div",Ce,[l(t(m),{for:"create-slug"},{default:a(()=>[...e[21]||(e[21]=[r("URL",-1)])]),_:1}),l(t(g),{id:"create-slug",modelValue:t(d).slug,"onUpdate:modelValue":e[2]||(e[2]=s=>t(d).slug=s),placeholder:"juan-perez"},null,8,["modelValue"])])]),o("div",je,[l(t(m),{for:"create-job_title"},{default:a(()=>[...e[22]||(e[22]=[r("Cargo",-1)])]),_:1}),l(t(g),{id:"create-job_title",modelValue:t(d).job_title,"onUpdate:modelValue":e[3]||(e[3]=s=>t(d).job_title=s),placeholder:"Asesor de Ventas"},null,8,["modelValue"])]),o("div",Ue,[l(t(m),{for:"create-slogan"},{default:a(()=>[...e[23]||(e[23]=[r("Slogan",-1)])]),_:1}),l(t(g),{id:"create-slogan",modelValue:t(d).slogan,"onUpdate:modelValue":e[4]||(e[4]=s=>t(d).slogan=s),placeholder:"Tu aliado en..."},null,8,["modelValue"])]),o("div",Pe,[l(t(m),{for:"create-bio"},{default:a(()=>[...e[24]||(e[24]=[r("Biografía",-1)])]),_:1}),z(o("textarea",{id:"create-bio","onUpdate:modelValue":e[5]||(e[5]=s=>t(d).bio=s),rows:"3",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm"},null,512),[[S,t(d).bio]])]),o("div",$e,[l(t(_),{type:"button",variant:"outline",onClick:e[6]||(e[6]=s=>y.value=!1)},{default:a(()=>[...e[25]||(e[25]=[r(" Cancelar ",-1)])]),_:1}),l(t(_),{type:"submit",disabled:t(d).processing},{default:a(()=>[...e[26]||(e[26]=[r(" Crear Perfil ",-1)])]),_:1},8,["disabled"])])],32)]),_:1}))]),_:1},8,["open"]),l(t(T),{open:!!f.value&&!k.value,"onUpdate:open":V,modal:!0},{default:a(()=>[k.value?c("",!0):(u(),w(t(B),{key:0,class:"max-w-lg"},{default:a(()=>[l(t(E),null,{default:a(()=>[l(t(M),null,{default:a(()=>[...e[27]||(e[27]=[r("Editar Perfil",-1)])]),_:1})]),_:1}),f.value?(u(),p("form",{key:0,onSubmit:C(R,["prevent"]),class:"space-y-4"},[l(t(N),{modelValue:t(i).photo,"onUpdate:modelValue":e[8]||(e[8]=s=>t(i).photo=s),"current-image":f.value.photo_url,label:"Foto","aspect-ratio":"square","max-size":2},null,8,["modelValue","current-image"]),o("div",ze,[o("div",Se,[l(t(m),{for:"edit-name"},{default:a(()=>[...e[28]||(e[28]=[r("Nombre *",-1)])]),_:1}),l(t(g),{id:"edit-name",modelValue:t(i).name,"onUpdate:modelValue":e[9]||(e[9]=s=>t(i).name=s),required:""},null,8,["modelValue"])]),f.value.is_primary?c("",!0):(u(),p("div",Fe,[l(t(m),{for:"edit-slug"},{default:a(()=>[...e[29]||(e[29]=[r("URL",-1)])]),_:1}),l(t(g),{id:"edit-slug",modelValue:t(i).slug,"onUpdate:modelValue":e[10]||(e[10]=s=>t(i).slug=s)},null,8,["modelValue"])]))]),o("div",Ne,[l(t(m),{for:"edit-job_title"},{default:a(()=>[...e[30]||(e[30]=[r("Cargo",-1)])]),_:1}),l(t(g),{id:"edit-job_title",modelValue:t(i).job_title,"onUpdate:modelValue":e[11]||(e[11]=s=>t(i).job_title=s)},null,8,["modelValue"])]),o("div",Be,[l(t(m),{for:"edit-slogan"},{default:a(()=>[...e[31]||(e[31]=[r("Slogan",-1)])]),_:1}),l(t(g),{id:"edit-slogan",modelValue:t(i).slogan,"onUpdate:modelValue":e[12]||(e[12]=s=>t(i).slogan=s)},null,8,["modelValue"])]),o("div",Ee,[l(t(m),{for:"edit-bio"},{default:a(()=>[...e[32]||(e[32]=[r("Biografía",-1)])]),_:1}),z(o("textarea",{id:"edit-bio","onUpdate:modelValue":e[13]||(e[13]=s=>t(i).bio=s),rows:"3",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm"},null,512),[[S,t(i).bio]])]),o("div",Me,[l(t(Z),{id:"edit-is_active",checked:t(i).is_active,"onUpdate:checked":e[14]||(e[14]=s=>t(i).is_active=s)},null,8,["checked"]),l(t(m),{for:"edit-is_active",class:"cursor-pointer"},{default:a(()=>[...e[33]||(e[33]=[r(" Perfil activo ",-1)])]),_:1})]),o("div",Te,[l(t(_),{type:"button",variant:"outline",onClick:V},{default:a(()=>[...e[34]||(e[34]=[r(" Cancelar ",-1)])]),_:1}),l(t(_),{type:"submit",disabled:t(i).processing,class:"gap-2"},{default:a(()=>[l(t(se),{class:"h-4 w-4"}),e[35]||(e[35]=r(" Guardar ",-1))]),_:1},8,["disabled"])])],32)):c("",!0)]),_:1}))]),_:1},8,["open"])]))}});export{Ye as _};
