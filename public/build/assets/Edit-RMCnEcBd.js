import{d as D,u as F,r as $,c as q,A as N,o as M,w as E,D as O,e as p,f as o,g as t,i as R,j as l,k as e,x,m,t as d,p as c,l as b,z as G,B as _,C as Q,F as w,s as h,E as S}from"./vendor-CwJ9eRpz.js";import{B as U,E as A,S as I,_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BrY3Mbxo.js";import{u as J}from"./useSwal-DOVGsU6a.js";import{_ as C}from"./RadioCard.vue_vue_type_script_setup_true_lang-B6lQHour.js";import{_ as K}from"./ImageUpload.vue_vue_type_script_setup_true_lang-BCuO3NCY.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-BOJ85c3X.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-DTGu4m7n.js";import{_ as W}from"./index-aHHv8Tf2.js";import{_ as X}from"./Checkbox.vue_vue_type_script_setup_true_lang-DtZyXLcU.js";import{_ as Y,a as Z,b as z,c as y,d as ss}from"./ProductsEditor.vue_vue_type_script_setup_true_lang-89NYmpP5.js";import{_ as es}from"./Spinner.vue_vue_type_script_setup_true_lang-Bz9eDeRC.js";import{_ as L}from"./ProfilePreview.vue_vue_type_script_setup_true_lang-Bpxqx8MN.js";import{_ as ts}from"./ProfileEditor.vue_vue_type_script_setup_true_lang-Dk8TMnLA.js";import{_ as os}from"./DesignEditor.vue_vue_type_script_setup_true_lang-CC4riswZ.js";import{_ as is}from"./SocialLinksEditor.vue_vue_type_script_setup_true_lang-CX6qATUq.js";import{_ as as}from"./CustomLinksEditor.vue_vue_type_script_setup_true_lang-BZ_i-lcQ.js";import{_ as ls}from"./AlertsEditor.vue_vue_type_script_setup_true_lang-9cuT-TNy.js";import{Q as rs,_ as ns}from"./QrEditor.vue_vue_type_script_setup_true_lang-CX_H6G6Y.js";import{E as ds}from"./eye-CMurwkyG.js";import{U as ms}from"./users-BOEnDdvz.js";import{P as us}from"./palette-B6LxOisj.js";import{L as fs}from"./link-2-BijLee4B.js";import{P as gs}from"./package-DtOv7Zct.js";import{B as cs}from"./bell-EpqQEzQD.js";import{U as ps}from"./user-Bp9gVkuh.js";import{S as vs}from"./save-Foej4Srl.js";import"./VisuallyHidden-DI7LxRb7.js";import"./useForwardExpose-CraSWOVP.js";import"./PopperContent-BZm8OVWI.js";import"./getActiveElement-FUKBWQwh.js";import"./useSize-DPlu3iF4.js";import"./Presence-DPRxqr4Y.js";import"./Teleport-DJyIM2_Y.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./RovingFocusGroup-Bg8F_nie.js";import"./Collection-DW7XR1O_.js";import"./index-By14V8Wx.js";import"./createLucideIcon-ColtdVoX.js";import"./DialogTitle-BN7VPbnW.js";import"./x-BzXzP8xs.js";import"./DialogDescription-BEVBDaXg.js";import"./layout-grid-xuEGYM1Q.js";import"./credit-card-mbP66do9.js";import"./chevron-right-CIYxK5Th.js";import"./check-BtJmg7Qw.js";import"./image-DEgvf-8L.js";import"./nullish-BeE1Irmw.js";import"./useFormControl-KH8CXA8R.js";import"./VisuallyHiddenInput-Cn8eJrYO.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-C18qZcbt.js";import"./tag-C7WvpRuP.js";import"./plus-ggKBdC47.js";import"./pencil-GOH_MpO7.js";import"./trash-2-CHHS8M2q.js";import"./star-BtP3YK3B.js";import"./loader-circle-CXEFMlnV.js";import"./ProductsCatalog.vue_vue_type_script_setup_true_lang-CKgOTfHu.js";import"./app-DH7hp9r8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./megaphone-ByB0xrLA.js";import"./circle-alert-B-UA-eer.js";import"./info-BAcL9D50.js";import"./download-Dhrr9OQm.js";import"./DialogDescription.vue_vue_type_script_setup_true_lang-C7GaPRR2.js";import"./crown-BwBjSWu3.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-D8OnKVtz.js";import"./clamp-BstbYvQo.js";import"./DesignBackgroundSection.vue_vue_type_script_setup_true_lang-DLA3lAoB.js";import"./ColorPicker.vue_vue_type_script_setup_true_lang-CmaLZnPB.js";import"./Slider.vue_vue_type_script_setup_true_lang-CyCdErQ-.js";import"./square-CsgyCoI1.js";import"./DesignAnimatedBackgroundSection.vue_vue_type_script_setup_true_lang-Bn8EXqOq.js";import"./triangle-alert-BvMonCjJ.js";import"./DesignColorsSection.vue_vue_type_script_setup_true_lang-CmfNbuUP.js";import"./DesignCardsSection.vue_vue_type_script_setup_true_lang-qt-cprF_.js";import"./sparkles-Bi2ToExK.js";import"./DesignAnimationsSection.vue_vue_type_script_setup_true_lang-DKomYbWC.js";import"./DesignEffectsSection.vue_vue_type_script_setup_true_lang-BlRcJ743.js";import"./Switch.vue_vue_type_script_setup_true_lang-CERVBZK9.js";import"./DesignLayoutSection.vue_vue_type_script_setup_true_lang-Brmp6oKA.js";import"./QrPreview-D0esbwTo.js";import"./refresh-cw-NYRbpxiN.js";const xs={class:"flex-1 p-4 md:p-6 min-h-0"},bs={class:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between"},zs={class:"flex items-center gap-4"},ys={class:"flex h-14 w-14 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-500/20 to-cyan-600/20"},ks=["src","alt"],_s={class:"text-xl font-bold"},ws=["href"],Vs={class:"flex items-center gap-3"},Ps=["href"],$s={key:0,class:"absolute inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm rounded-lg"},hs={class:"flex flex-col items-center gap-2"},Ss={class:"ml-1 rounded-full bg-muted px-1.5 py-0.5 text-xs"},Es={class:"ml-1 rounded-full bg-muted px-1.5 py-0.5 text-xs"},Us={class:"grid gap-6 lg:grid-cols-2"},Cs={class:"space-y-6 rounded-xl border bg-card p-6"},js={class:"space-y-2"},Ls={class:"space-y-2"},Bs={class:"flex items-center gap-2"},Ts={class:"space-y-3"},Ds={class:"grid gap-3 sm:grid-cols-2"},Fs={class:"space-y-2"},qs={class:"flex items-center gap-3"},Ns={class:"space-y-6"},Ms={class:"rounded-xl border bg-card p-6"},Os={class:"grid grid-cols-2 gap-4"},Rs={class:"rounded-lg bg-muted p-4 text-center"},Gs={class:"text-2xl font-bold"},Qs={class:"rounded-lg bg-muted p-4 text-center"},As={class:"text-2xl font-bold"},Is={class:"rounded-xl border bg-card p-6"},Hs={class:"space-y-3 text-sm"},Js={class:"flex justify-between"},Ks={class:"flex justify-between"},Ws={class:"flex justify-between"},Xs={class:"flex justify-between"},Ys={class:"grid gap-6 lg:grid-cols-2"},Zs={class:"space-y-6"},se={class:"flex items-center gap-4"},ee=["value"],te={class:"space-y-4"},oe={class:"grid gap-6 lg:grid-cols-2"},ie={class:"space-y-6"},ae={class:"flex items-center gap-4"},le=["value"],re={class:"space-y-4"},ne={class:"space-y-6"},de={class:"flex items-center gap-4 rounded-xl border bg-card p-4"},me=["value"],Nt=D({__name:"Edit",props:{organization:{},limits:{},socialPlatforms:{}},setup(i){const g=i,B=F(),k=J(),V=$("general"),P=$(!1),u=$(g.organization.profiles.find(r=>r.is_primary)?.id||g.organization.profiles[0]?.id||null),f=q(()=>g.organization.profiles.find(r=>r.id===u.value)),n=N({name:g.organization.name,slug:g.organization.slug,type:g.organization.type,description:g.organization.description||"",logo:null,is_active:g.organization.is_active});function T(){n.logo instanceof File?n.transform(r=>({...r,_method:"PUT"})).post(`/admin/organizations/${g.organization.id}`,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{k.success("¡Cambios guardados!"),n.logo=null},onError:r=>{console.error("Error al guardar:",r),k.error("Error al guardar los cambios. Por favor, verifica los datos.")}}):n.transform(r=>{const{logo:s,...a}=r;return a}).put(`/admin/organizations/${g.organization.id}`,{preserveScroll:!0,onSuccess:()=>{k.success("¡Cambios guardados!"),n.logo=null},onError:r=>{console.error("Error al guardar:",r),k.error("Error al guardar los cambios. Por favor, verifica los datos.")}})}return M(()=>{const r=B.props.flash;r?.success&&k.success(r.success),r?.error&&k.error(r.error)}),E(()=>g.organization.profiles,r=>{!u.value&&r.length>0&&(u.value=r.find(s=>s.is_primary)?.id||r[0].id)}),E(V,async()=>{P.value=!0,await O(),setTimeout(()=>{P.value=!1},150)}),(r,s)=>(m(),p(w,null,[o(t(R),{title:`Editar ${i.organization.name}`},null,8,["title"]),o(H,{breadcrumbs:[{title:"Dashboard",href:"/admin"},{title:"Organizaciones",href:"/admin/organizations"},{title:i.organization.name,href:`/admin/organizations/${i.organization.id}/edit`}]},{default:l(()=>[e("div",xs,[e("div",bs,[e("div",zs,[e("div",ys,[i.organization.logo_url?(m(),p("img",{key:0,src:i.organization.logo_url,alt:i.organization.name,class:"h-full w-full rounded-xl object-cover"},null,8,ks)):(m(),x(t(U),{key:1,class:"h-7 w-7 text-cyan-600"}))]),e("div",null,[e("h1",_s,d(i.organization.name),1),e("a",{href:`/${i.organization.slug}`,target:"_blank",class:"flex items-center gap-1 text-sm text-muted-foreground hover:text-primary"},[c(" conectlink.cnva.mx/"+d(i.organization.slug)+" ",1),o(t(A),{class:"h-3 w-3"})],8,ws)])]),e("div",Vs,[e("a",{href:`/${i.organization.slug}`,target:"_blank",class:"flex items-center gap-2 rounded-lg border px-4 py-2 text-sm font-medium hover:bg-muted"},[o(t(ds),{class:"h-4 w-4"}),s[13]||(s[13]=c(" Ver Organización ",-1))],8,Ps)])]),o(t(Y),{modelValue:V.value,"onUpdate:modelValue":s[12]||(s[12]=a=>V.value=a),class:"relative space-y-6"},{default:l(()=>[P.value?(m(),p("div",$s,[e("div",hs,[o(t(es),{class:"h-6 w-6"}),s[14]||(s[14]=e("span",{class:"text-sm text-muted-foreground"},"Cargando...",-1))])])):b("",!0),o(t(Z),{class:"w-full justify-start overflow-x-auto"},{default:l(()=>[o(t(z),{value:"general",class:"gap-2"},{default:l(()=>[o(t(I),{class:"h-4 w-4"}),s[15]||(s[15]=e("span",{class:"hidden sm:inline"},"General",-1))]),_:1}),o(t(z),{value:"profiles",class:"gap-2"},{default:l(()=>[o(t(ms),{class:"h-4 w-4"}),s[16]||(s[16]=e("span",{class:"hidden sm:inline"},"Perfiles",-1)),e("span",Ss,d(i.organization.profiles.length),1)]),_:1}),o(t(z),{value:"design",class:"gap-2"},{default:l(()=>[o(t(us),{class:"h-4 w-4"}),s[17]||(s[17]=e("span",{class:"hidden sm:inline"},"Diseño",-1))]),_:1}),o(t(z),{value:"links",class:"gap-2"},{default:l(()=>[o(t(fs),{class:"h-4 w-4"}),s[18]||(s[18]=e("span",{class:"hidden sm:inline"},"Links",-1))]),_:1}),o(t(z),{value:"products",class:"gap-2"},{default:l(()=>[o(t(gs),{class:"h-4 w-4"}),s[19]||(s[19]=e("span",{class:"hidden sm:inline"},"Productos",-1)),e("span",Es,d(i.organization.products.length),1)]),_:1}),o(t(z),{value:"alerts",class:"gap-2"},{default:l(()=>[o(t(cs),{class:"h-4 w-4"}),s[20]||(s[20]=e("span",{class:"hidden sm:inline"},"Alertas",-1))]),_:1}),o(t(z),{value:"qr",class:"gap-2"},{default:l(()=>[o(t(rs),{class:"h-4 w-4"}),s[21]||(s[21]=e("span",{class:"hidden sm:inline"},"QR & Tarjetas",-1))]),_:1})]),_:1}),o(t(y),{value:"general",class:"space-y-6"},{default:l(()=>[e("div",Us,[e("div",Cs,[s[29]||(s[29]=e("h2",{class:"font-semibold"},"Información General",-1)),e("form",{onSubmit:G(T,["prevent"]),class:"space-y-6"},[o(t(K),{modelValue:t(n).logo,"onUpdate:modelValue":s[0]||(s[0]=a=>t(n).logo=a),"current-image":i.organization.logo_url,label:"Logo","aspect-ratio":"square","max-size":2},null,8,["modelValue","current-image"]),e("div",js,[o(t(v),{for:"name"},{default:l(()=>[...s[22]||(s[22]=[c("Nombre",-1)])]),_:1}),o(t(j),{id:"name",modelValue:t(n).name,"onUpdate:modelValue":s[1]||(s[1]=a=>t(n).name=a),type:"text",required:""},null,8,["modelValue"])]),e("div",Ls,[o(t(v),{for:"slug"},{default:l(()=>[...s[23]||(s[23]=[c("URL",-1)])]),_:1}),e("div",Bs,[s[24]||(s[24]=e("span",{class:"text-sm text-muted-foreground"},"conectlink.cnva.mx/",-1)),o(t(j),{id:"slug",modelValue:t(n).slug,"onUpdate:modelValue":s[2]||(s[2]=a=>t(n).slug=a),type:"text",class:"font-mono",required:""},null,8,["modelValue"])])]),e("div",Ts,[o(t(v),null,{default:l(()=>[...s[25]||(s[25]=[c("Tipo",-1)])]),_:1}),e("div",Ds,[o(t(C),{modelValue:t(n).type,"onUpdate:modelValue":s[3]||(s[3]=a=>t(n).type=a),value:"business",label:"Empresa",icon:t(U)},null,8,["modelValue","icon"]),o(t(C),{modelValue:t(n).type,"onUpdate:modelValue":s[4]||(s[4]=a=>t(n).type=a),value:"personal",label:"Personal",icon:t(ps)},null,8,["modelValue","icon"])])]),e("div",Fs,[o(t(v),{for:"description"},{default:l(()=>[...s[26]||(s[26]=[c("Descripción",-1)])]),_:1}),_(e("textarea",{id:"description","onUpdate:modelValue":s[5]||(s[5]=a=>t(n).description=a),rows:"3",class:"w-full rounded-lg border bg-background px-4 py-3 text-sm",maxlength:"500"},null,512),[[Q,t(n).description]])]),e("div",qs,[o(t(X),{id:"is_active",checked:t(n).is_active,"onUpdate:checked":s[6]||(s[6]=a=>t(n).is_active=a)},null,8,["checked"]),o(t(v),{for:"is_active",class:"cursor-pointer"},{default:l(()=>[...s[27]||(s[27]=[c(" Organización activa (visible públicamente) ",-1)])]),_:1})]),o(t(W),{type:"submit",disabled:t(n).processing,class:"w-full gap-2"},{default:l(()=>[o(t(vs),{class:"h-4 w-4"}),s[28]||(s[28]=c(" Guardar Cambios ",-1))]),_:1},8,["disabled"])],32)]),e("div",Ns,[e("div",Ms,[s[32]||(s[32]=e("h2",{class:"font-semibold mb-4"},"Resumen",-1)),e("div",Os,[e("div",Rs,[e("p",Gs,d(i.organization.profiles.length),1),s[30]||(s[30]=e("p",{class:"text-sm text-muted-foreground"},"Perfiles",-1))]),e("div",Qs,[e("p",As,d(i.organization.products.length),1),s[31]||(s[31]=e("p",{class:"text-sm text-muted-foreground"},"Productos",-1))])])]),e("div",Is,[s[37]||(s[37]=e("h2",{class:"font-semibold mb-4"},"Límites de tu Plan",-1)),e("div",Hs,[e("div",Js,[s[33]||(s[33]=e("span",{class:"text-muted-foreground"},"Perfiles",-1)),e("span",null,d(i.organization.profiles.length)+"/"+d(i.limits.max_profiles),1)]),e("div",Ks,[s[34]||(s[34]=e("span",{class:"text-muted-foreground"},"Productos",-1)),e("span",null,d(i.organization.products.length)+"/"+d(i.limits.max_products),1)]),e("div",Ws,[s[35]||(s[35]=e("span",{class:"text-muted-foreground"},"Links personalizados",-1)),e("span",null,d(i.limits.max_custom_links)+" por perfil",1)]),e("div",Xs,[s[36]||(s[36]=e("span",{class:"text-muted-foreground"},"Redes sociales",-1)),e("span",null,d(i.limits.max_social_links)+" por perfil",1)])])])])])]),_:1}),o(t(y),{value:"profiles"},{default:l(()=>[o(ts,{organization:i.organization,limits:i.limits,"selected-profile-id":u.value,onSelectProfile:s[7]||(s[7]=a=>u.value=a)},null,8,["organization","limits","selected-profile-id"])]),_:1}),o(t(y),{value:"design"},{default:l(()=>[o(os,{organization:i.organization,"selected-profile-id":u.value,onSelectProfile:s[8]||(s[8]=a=>u.value=a)},null,8,["organization","selected-profile-id"])]),_:1}),o(t(y),{value:"links"},{default:l(()=>[e("div",Ys,[e("div",Zs,[e("div",se,[o(t(v),null,{default:l(()=>[...s[38]||(s[38]=[c("Editando perfil:",-1)])]),_:1}),_(e("select",{"onUpdate:modelValue":s[9]||(s[9]=a=>u.value=a),class:"rounded-lg border bg-background px-3 py-2 text-sm"},[(m(!0),p(w,null,h(i.organization.profiles,a=>(m(),p("option",{key:a.id,value:a.id},d(a.name)+" "+d(a.is_primary?"(Principal)":""),9,ee))),128))],512),[[S,u.value]])]),f.value?(m(),x(is,{key:0,profile:f.value,platforms:i.socialPlatforms,"max-links":i.limits.max_social_links},null,8,["profile","platforms","max-links"])):b("",!0),f.value?(m(),x(as,{key:1,profile:f.value,"max-links":i.limits.max_custom_links},null,8,["profile","max-links"])):b("",!0)]),e("div",te,[s[39]||(s[39]=e("h2",{class:"font-semibold"},"Vista Previa",-1)),f.value?(m(),x(L,{key:0,profile:f.value,organization:{...i.organization,products:i.organization.products||[],productCategories:i.organization.productCategories||[],productSections:i.organization.productSections||[]}},null,8,["profile","organization"])):b("",!0)])])]),_:1}),o(t(y),{value:"products"},{default:l(()=>[o(ss,{organization:i.organization,limits:i.limits},null,8,["organization","limits"])]),_:1}),o(t(y),{value:"alerts"},{default:l(()=>[e("div",oe,[e("div",ie,[e("div",ae,[o(t(v),null,{default:l(()=>[...s[40]||(s[40]=[c("Editando perfil:",-1)])]),_:1}),_(e("select",{"onUpdate:modelValue":s[10]||(s[10]=a=>u.value=a),class:"rounded-lg border bg-background px-3 py-2 text-sm"},[(m(!0),p(w,null,h(i.organization.profiles,a=>(m(),p("option",{key:a.id,value:a.id},d(a.name)+" "+d(a.is_primary?"(Principal)":""),9,le))),128))],512),[[S,u.value]])]),f.value?(m(),x(ls,{key:0,profile:f.value,"max-alerts":i.limits.max_alerts},null,8,["profile","max-alerts"])):b("",!0)]),e("div",re,[s[41]||(s[41]=e("h2",{class:"font-semibold"},"Vista Previa",-1)),f.value?(m(),x(L,{key:0,profile:f.value,organization:{...i.organization,products:i.organization.products||[],productCategories:i.organization.productCategories||[],productSections:i.organization.productSections||[]}},null,8,["profile","organization"])):b("",!0)])])]),_:1}),o(t(y),{value:"qr"},{default:l(()=>[e("div",ne,[e("div",de,[o(t(v),null,{default:l(()=>[...s[42]||(s[42]=[c("Perfil seleccionado:",-1)])]),_:1}),_(e("select",{"onUpdate:modelValue":s[11]||(s[11]=a=>u.value=a),class:"rounded-lg border bg-background px-3 py-2 text-sm"},[(m(!0),p(w,null,h(i.organization.profiles,a=>(m(),p("option",{key:a.id,value:a.id},d(a.name)+" "+d(a.is_primary?"(Principal)":""),9,me))),128))],512),[[S,u.value]])]),f.value?(m(),x(ns,{key:0,profile:f.value,organization:i.organization},null,8,["profile","organization"])):b("",!0)])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["breadcrumbs"])],64))}});export{Nt as default};
